<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Block Tridiagonal Matrices | Mikkel Paltorp </title> <meta name="author" content="Mikkel Paltorp"> <meta name="description" content="and their relation to semiseparable matrices and state-space models"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%94%AC&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://mipals.github.io/blog/2025/block-tridiagonal/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Block Tridiagonal Matrices",
            "description": "and their relation to semiseparable matrices and state-space models",
            "published": "July 28, 2025",
            "authors": [
              
              {
                "author": "Mikkel Paltorp",
                "authorURL": "https://mipals.github.io",
                "affiliations": [
                  {
                    "name": "Technical University of Denmark",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Mikkel</span> Paltorp </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Block Tridiagonal Matrices</h1> <p>and their relation to semiseparable matrices and state-space models</p> </d-title> <d-byline></d-byline> <d-article> <p>We will in this post restrict ourselves to the case of symmetric block tridiagonal matrices. These matrices occur in the context of state space models, since the state transition matrix is lower block bidiagonal resulting in the covariance matrix being symmetric block tridiagonal. It turns out that the inverse of a symmetric block tridiagonal matrix is semiseparable with separability rank equal to the size of the blocks <d-cite key="meurant1992a"></d-cite>. We introduce the following notation for a symmetric block tridiagonal matrix</p> \[\bK = \begin{bmatrix} \bD_1 &amp; -\bA_2^\top &amp; &amp; &amp; \\ -\bA_2 &amp; \bD_2 &amp; -\bA_3^\top &amp; &amp; \\ &amp; \ddots &amp; \ddots &amp; \ddots &amp; \\ &amp; &amp; -\bA_{N-1} &amp; \bD_{N-1} &amp; -\bA_{N}^\top\\ &amp; &amp; &amp; -\bA_T &amp; \bD_T \end{bmatrix}.\] <p>It turns out that the matrix can be factorized in two ways as follows</p> \[\bK = \left(\Delta + \bL\right)\Delta^{-1}\left(\Delta + \bL^\top\right) = \left(\Sigma + \bL^\top\right)\Sigma^{-1}\left(\Sigma + \bL\right) ,\] <p>where $\bL$ is the matrix of lower triangular blocks and $\Delta$ and $\Sigma$ are block diagonal matrices with blocks computed as follows</p> \[\begin{cases} \Delta_1 = \bD_1, \\ \Delta_i = \bD_i - \bA_i\Delta_{i-1}^{-1}\bA_i^\top \end{cases}, \quad \begin{cases} \Sigma_T = \bD_T, \\ \Sigma_i = \bD_i - \bA_{i+1}^\top\Sigma_{i+1}^{-1}\bA_{i+1} \end{cases}.\] <p>In the case of the of diagonal blocks ($\bA_i$) being invertible, and using $\Delta$ and $\Sigma$, then $\bK^{-1}$ is semiseparable generator representable. In short this means that the inverse of $\bK$ can be written as</p> \[\bK^{-1} = \text{tril}\left(\bU\bV^\top\right) + \text{triu}\left(\bV\bU^\top,1\right).\] <p>where the so-called generators $\bU$ and $\bV$ can be computed as</p> \[\label{eq:generators} \begin{cases} \bU_1 = \Sigma_1^{-1}\\ \bU_i = \Sigma_{i}^{-1}\bA_i\bU_{i-1} \end{cases}, \quad \begin{cases} \bV_1 = \bI\\ \bV_i = \bA_i^{-\top}\Delta_{i-1}\bV_{i-1} \end{cases},\] <p>The semiseparable representation extremely important computationally. We have that $\bU,\bV\in\mathbb{R}^{nT\times n}$ which mean that it is a data-sparse representation of $\bK^{-1}\in\mathbb{R}^{nT\times nT}$ (we have $D_i \in \mathbb{R}^{n\times n}$ and $N$ being the number of states. In most cases $n \ll N$ meaning that the representation is extremely efficient). At the same time the structure make is possible to compute various important linear algebraic operation in $O(n^2T)$ that in the dense case would have scaled as $O((nT)^3)$ <d-cite key="andersen2020a"></d-cite>.</p> <p>Some Julia code implementing the above is given below.</p> <details><summary>Code</summary> <div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">LinearAlgebra</span><span class="x">,</span> <span class="n">LinearAlgebra</span><span class="x">,</span> <span class="n">BlockBandedMatrices</span><span class="x">,</span> <span class="n">Test</span>

<span class="n">T</span> <span class="o">=</span> <span class="mi">5</span> <span class="c"># Sequence length</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span> <span class="c"># blk sizes</span>

<span class="n">A_blks</span> <span class="o">=</span> <span class="x">[</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="n">zeros</span><span class="x">(</span><span class="n">n</span><span class="x">,</span><span class="n">n</span><span class="x">)</span> <span class="o">:</span> <span class="n">exp</span><span class="x">(</span><span class="n">rand</span><span class="x">(</span><span class="n">n</span><span class="x">,</span><span class="n">n</span><span class="x">))</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">T</span><span class="x">]</span> 
<span class="n">D_blks</span> <span class="o">=</span> <span class="x">[</span><span class="kt">Matrix</span><span class="x">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">I</span><span class="x">(</span><span class="n">n</span><span class="x">))</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">T</span><span class="x">]</span>
<span class="n">A_blks_transposed</span> <span class="o">=</span> <span class="x">[</span><span class="n">A_blk</span><span class="err">'</span> <span class="k">for</span> <span class="n">A_blk</span> <span class="k">in</span> <span class="n">A_blks</span><span class="x">]</span>
<span class="n">zero_blks</span> <span class="o">=</span> <span class="x">[</span><span class="n">zeros</span><span class="x">(</span><span class="n">n</span><span class="x">,</span><span class="n">n</span><span class="x">)</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">T</span><span class="x">]</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">BlockTridiagonal</span><span class="x">(</span><span class="o">-</span><span class="n">A_blks</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="x">],</span> <span class="n">D_blks</span><span class="x">,</span> <span class="o">-</span><span class="n">A_blks_transposed</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="x">])</span>
<span class="n">Δ_blks</span> <span class="o">=</span> <span class="n">copy</span><span class="x">(</span><span class="n">D_blks</span><span class="x">)</span>
<span class="n">Σ_blks</span> <span class="o">=</span> <span class="n">copy</span><span class="x">(</span><span class="n">D_blks</span><span class="x">)</span>
<span class="k">for</span> <span class="x">(</span><span class="n">i</span><span class="x">,</span><span class="n">j</span><span class="x">)</span> <span class="k">in</span> <span class="n">zip</span><span class="x">(</span><span class="mi">2</span><span class="o">:</span><span class="n">length</span><span class="x">(</span><span class="n">D_blks</span><span class="x">),</span><span class="n">length</span><span class="x">(</span><span class="n">D_blks</span><span class="x">)</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="x">)</span>
    <span class="n">Δ_blks</span><span class="x">[</span><span class="n">i</span><span class="x">]</span>   <span class="o">=</span> <span class="n">D_blks</span><span class="x">[</span><span class="n">i</span><span class="x">]</span> <span class="o">-</span> <span class="n">A_blks</span><span class="x">[</span><span class="n">i</span><span class="x">]</span><span class="o">*</span><span class="x">(</span><span class="n">Δ_blks</span><span class="x">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">\</span><span class="n">A_blks</span><span class="x">[</span><span class="n">i</span><span class="x">]</span><span class="err">'</span><span class="x">)</span>
    <span class="n">Σ_blks</span><span class="x">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span> <span class="o">=</span> <span class="n">D_blks</span><span class="x">[</span><span class="n">j</span><span class="x">]</span> <span class="o">-</span> <span class="n">A_blks</span><span class="x">[</span><span class="n">j</span><span class="x">]</span><span class="err">'</span><span class="o">*</span><span class="x">(</span><span class="n">Σ_blks</span><span class="x">[</span><span class="n">j</span><span class="x">]</span><span class="o">\</span><span class="n">A_blks</span><span class="x">[</span><span class="n">j</span><span class="x">])</span>
<span class="k">end</span>

<span class="n">L</span> <span class="o">=</span> <span class="n">BlockTridiagonal</span><span class="x">(</span><span class="o">-</span><span class="n">A_blks</span><span class="x">[</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="x">],</span> <span class="n">zero_blks</span><span class="x">,</span> <span class="n">zero_blks</span><span class="x">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="x">])</span>
<span class="n">Δ</span> <span class="o">=</span> <span class="n">BlockTridiagonal</span><span class="x">(</span><span class="n">zero_blks</span><span class="x">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="x">],</span> <span class="n">Δ_blks</span><span class="x">,</span> <span class="n">zero_blks</span><span class="x">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="x">])</span>
<span class="n">Σ</span> <span class="o">=</span> <span class="n">BlockTridiagonal</span><span class="x">(</span><span class="n">zero_blks</span><span class="x">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="x">],</span> <span class="n">Σ_blks</span><span class="x">,</span> <span class="n">zero_blks</span><span class="x">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="x">])</span>

<span class="nd">@test</span> <span class="x">(</span><span class="n">Δ</span> <span class="o">+</span> <span class="n">L</span><span class="x">)</span><span class="o">*</span><span class="x">(</span><span class="n">Δ</span><span class="o">\</span><span class="x">(</span><span class="n">Δ</span> <span class="o">+</span> <span class="n">L</span><span class="err">'</span><span class="x">))</span> <span class="n">≈</span> <span class="n">K</span>
<span class="nd">@test</span> <span class="x">(</span><span class="n">Σ</span> <span class="o">+</span> <span class="n">L</span><span class="err">'</span><span class="x">)</span><span class="o">*</span><span class="x">(</span><span class="n">Σ</span><span class="o">\</span><span class="x">(</span><span class="n">Σ</span> <span class="o">+</span> <span class="n">L</span><span class="x">))</span> <span class="n">≈</span> <span class="n">K</span>

<span class="c"># Creating the semiseperable form</span>
<span class="n">V_blk</span> <span class="o">=</span> <span class="x">[</span><span class="kt">Matrix</span><span class="x">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">I</span><span class="x">(</span><span class="n">n</span><span class="x">))</span> <span class="k">for</span> <span class="n">_</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">T</span><span class="x">]</span>
<span class="n">U_blk</span> <span class="o">=</span> <span class="x">[</span><span class="kt">Matrix</span><span class="x">(</span><span class="mf">1.0</span><span class="o">*</span><span class="n">I</span><span class="x">(</span><span class="n">n</span><span class="x">))</span> <span class="k">for</span> <span class="n">_</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">T</span><span class="x">]</span>
<span class="n">U_blk</span><span class="x">[</span><span class="mi">1</span><span class="x">]</span> <span class="o">=</span> <span class="n">inv</span><span class="x">(</span><span class="n">Σ_blks</span><span class="x">[</span><span class="mi">1</span><span class="x">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">2</span><span class="o">:</span><span class="n">T</span>
    <span class="n">U_blk</span><span class="x">[</span><span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">Σ_blks</span><span class="x">[</span><span class="n">i</span><span class="x">]</span><span class="err">'</span><span class="o">\</span><span class="n">A_blks</span><span class="x">[</span><span class="n">i</span><span class="x">]</span><span class="o">*</span><span class="n">U_blk</span><span class="x">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span>
    <span class="n">V_blk</span><span class="x">[</span><span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="n">A_blks</span><span class="x">[</span><span class="n">i</span><span class="x">]</span><span class="err">'</span><span class="o">\</span><span class="x">(</span><span class="n">Δ_blks</span><span class="x">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="x">]</span><span class="o">*</span><span class="n">V_blk</span><span class="x">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="x">])</span>
<span class="k">end</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">vcat</span><span class="x">(</span><span class="n">U_blk</span><span class="o">...</span><span class="x">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">vcat</span><span class="x">(</span><span class="n">V_blk</span><span class="o">...</span><span class="x">)</span>
<span class="nd">@test</span> <span class="n">tril</span><span class="x">(</span><span class="n">U</span><span class="o">*</span><span class="n">V</span><span class="err">'</span><span class="x">)</span> <span class="n">≈</span> <span class="n">tril</span><span class="x">(</span><span class="n">inv</span><span class="x">(</span><span class="n">K</span><span class="x">))</span>
<span class="nd">@test</span> <span class="n">triu</span><span class="x">(</span><span class="n">V</span><span class="o">*</span><span class="n">U</span><span class="err">'</span><span class="x">)</span> <span class="n">≈</span> <span class="n">triu</span><span class="x">(</span><span class="n">inv</span><span class="x">(</span><span class="n">K</span><span class="x">))</span>

</code></pre></div></div> </details> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2018-12-22-distill.bib"></d-bibliography> <d-article> <br> <br> <div id="giscus_thread"> <script>
      let giscusTheme = determineComputedTheme();
      let giscusAttributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'mipals/mipals.github.io',
        'data-repo-id': '',
        'data-category': 'Comments',
        'data-category-id': '',
        'data-mapping': 'title',
        'data-strict': '1',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': giscusTheme,
        'data-lang': 'en',
        crossorigin: 'anonymous',
        async: '',
      };

      let giscusScript = document.createElement('script');
      Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));
      document.getElementById('giscus_thread').appendChild(giscusScript);
    </script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </d-article> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Mikkel Paltorp. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/overrides.js"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?5a16f3fff810d102bb6b8d68a4e2e358"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>