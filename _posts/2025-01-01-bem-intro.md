---
layout: distill
title: The Boundary Element Method (BEM)
description: a brief introduction
tags: linear-algebra gaussian-processes low-rank-approximation randomized-linear-algebra
giscus_comments: true
date: 2025-01-01 13:00:00
featured: false
# citation: true

authors:
  - name: Mikkel Paltorp
    url: "https://mipals.github.io"
    affiliations:
      name: Technical University of Denmark

bibliography: 2025-05-25-continuous-matrix-factorization.bib

# Optionally, you can add a table of contents to your post.
# NOTES:
#   - make sure that TOC names match the actual section names
#     for hyperlinks within the post to work correctly.
#   - we may want to automate TOC generation in the future using
#     jekyll-toc plugin (https://github.com/toshimaru/jekyll-toc).
toc:
  - name: Introduction
  - name: The (Discrete) Cholesky Factorization
  - name: Kernel Matrices and Kernel Functions
  - name: The Continuous Cholesky Factorization
  - name: Visual Representations
  - name: Final remarks

# Below is an example of injecting additional post-specific styles.
# If you use this post as a template, delete this _styles block.
_styles: >
  .fake-img {
    background: #bbb;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 12px;
  }
  .fake-img p {
    font-family: monospace;
    color: white;
    text-align: left;
    margin: 12px 0;
    text-align: center;
    font-size: 16px;
  }
---


# An Introduction to the Boundary Element Method (BEM)
In simple terms the Boundary Element Method (BEM) works  by solving integral equations through a discretization of both the physics (unknown function) and the domain (geometry). In this note we only touch upon the discretization of the physics and how that can be used to reduce the problem into solving a linear system of equations using the so-called collocation approach (if you're interested in the Galerkin approach look [here](/pubs/pde/BEM_galerkin/)). In the world of exterior acoustical problems the integral equation that we aim to solve is the following

$$
C^{+}(\mathbf{x})p(\mathbf{x}) = \int_{\partial\Omega}\left[ \frac{\partial G(\mathbf{x},\mathbf{y})}{\partial \mathbf{n}_\mathbf{y}}p(\mathbf{y}) - 
G(\mathbf{x},\mathbf{y})\frac{\partial p}{\partial \mathbf{n}_\mathbf{y}}(\mathbf{y})\right]\ \mathrm{d}S_\mathbf{y},
$$

where the unknown functions of interest is $p$ and $\frac{\partial p}{\partial \mathbf{n}}$. However, one can not simply ask the computer to find the *functions* $p$ and $\frac{\partial p}{\partial \mathbf{n}}$ which solves the above integral equation. Instead, we need to *parametrize* a *family* of functions for which we hope that a solution for $p(\mathbf{x})$ and $\frac{\partial p}{\partial \mathbf{n}_\mathbf{x}}(\mathbf{x})$ and then setup a system of equations and solve for the parameters. The parametrization can be done in a plethora of ways, but for most element methods it chosen in the simplest way possible: As a linear combination of functions

$$
p(\mathbf{x}) \approx \mathbf{T}(x)\mathbf{p}, \quad \frac{\partial p}{\partial n_\mathbf{x}}(\mathbf{x}) \approx \mathbf{T}\left(x\right)\frac{\partial \mathbf{p}}{\partial \mathbf{n}_\mathbf{x}}.
$$

Note that the above is linear in the parameters $\mathbf{p}$ and $\frac{\partial \mathbf{p}}{\partial \mathbf{n}_\mathbf{x}}$, but not necessarily in the basis functions $\mathbf{T}(\mathbf{x})$. Taking the pressure as the example we can write out the approximation

$$
p(\mathbf{x})\approx \begin{bmatrix}T_1(\mathbf{x}) & T_2(\mathbf{x}) & \dots T_n(\mathbf{x})\end{bmatrix}\begin{bmatrix}p_1\\ p_2\\ \vdots\\ p_n\end{bmatrix}, \quad \frac{\partial p}{\partial n_\mathbf{x}}(\mathbf{x})\approx \begin{bmatrix}T_1(\mathbf{x}) & T_2(\mathbf{x}) & \dots T_n(\mathbf{x})\end{bmatrix}\begin{bmatrix}\partial_\mathbf{n} p_1\\ \partial_\mathbf{n}p_2\\ \vdots\\ \partial_\mathbf{n}p_n\end{bmatrix},
$$

where $p_i$ ($\partial_\mathbf{n}p_i$) is the pressure (normal derivative of the pressure) at point $\mathbf{x}_i$. This property is called the Cardinal property which can be expressed as

$$
T_i(\mathbf{x}_j) = \delta_{ij},
$$

such that

$$
\mathbf{T}(\mathbf{x}_j)\mathbf{p} = p_j, \quad \mathbf{T}(\mathbf{x}_j)\frac{\partial\mathbf{p}}{\partial\mathbf{n}_\mathbf{x}} = \partial_\mathbf{n}p_j
$$

The functions $T_i(\mathbf{x})$ are chosen to be *simple*, which in most caases mean polynomials of various orders. 

Now inserting the parametizations into the integral equation one find that

$$
\begin{align}
C^{+}(\mathbf{x})p(\mathbf{x})
&\approx \int_{\partial\Omega}\left[ \frac{\partial G(\mathbf{x},\mathbf{y})}{\partial \mathbf{n}_\mathbf{y}}\mathbf{T}(y)\mathbf{p} - 
G(\mathbf{x},\mathbf{y})\mathbf{T}\left(y\right)\frac{\partial \mathbf{p}}{\partial \mathbf{n}_\mathbf{y}}\right]\ \mathrm{d}S_\mathbf{y}\\
&= \left(\int_{\partial\Omega} \frac{\partial G(\mathbf{x},\mathbf{y})}{\partial \mathbf{n}_\mathbf{y}}\mathbf{T}(y)\ \mathrm{d}S_\mathbf{y}\right)\mathbf{p} - \left(\int_{\partial\Omega}
G(\mathbf{x},\mathbf{y})\mathbf{T}\left(y\right)\ \mathrm{d}S_\mathbf{y}\right)\frac{\partial \mathbf{p}}{\partial \mathbf{n}_\mathbf{y}}.
\end{align}
$$

The next step is to perform so-called *collocation* on all of the $n$ nodes. The reason for this is simply that the above only give us a single equation, but we have $n$ unknowns (since the boundary conditions will give us either $p_i$, $\frac{\partial p_i}{\partial\mathbf{n}_\mathbf{x}}$ or a combination of the two at any point on the surface). Collocation on node 1 looks as follows

$$
C^{+}(\mathbf{x}_1)p(\mathbf{x}_1)= C_1^{+}p_1 \approx \left(\int_{\partial\Omega} \frac{\partial G(\mathbf{x}_1,\mathbf{y})}{\partial \mathbf{n}_\mathbf{y}}\mathbf{T}(y)\ \mathrm{d}S_\mathbf{y}\right)\mathbf{p} - \left(\int_{\partial\Omega}
G(\mathbf{x}_1,\mathbf{y})\mathbf{T}\left(y\right)\ \mathrm{d}S_\mathbf{y}\right)\frac{\partial \mathbf{p}}{\partial \mathbf{n}_\mathbf{y}},
$$

where we used the constraint on the basis functions that stated that $p(\mathbf{x}_1) = p_1$ and $C^+(\mathbf{x}_1)=C^+_1$. Collecting the equations from collocating on the remaining $n-1$ nodes will result in the following linear system of equations

$$
\text{diag}\left(\begin{bmatrix}C_1^{+}\\ C_2^{+}\\ \vdots \\ C_n^{+}\end{bmatrix}\right)\mathbf{p} = 
\begin{bmatrix}
\int_{\partial\Omega} \frac{\partial G(\mathbf{x}_1,\mathbf{y})}{\partial \mathbf{n}_\mathbf{y}}\mathbf{T}(y)\ \mathrm{d}S_\mathbf{y}\\
\int_{\partial\Omega} \frac{\partial G(\mathbf{x}_2,\mathbf{y})}{\partial \mathbf{n}_\mathbf{y}}\mathbf{T}(y)\ \mathrm{d}S_\mathbf{y}\\
\vdots\\
\int_{\partial\Omega} \frac{\partial G(\mathbf{x}_n,\mathbf{y})}{\partial \mathbf{n}_\mathbf{y}}\mathbf{T}(y)\ \mathrm{d}S_\mathbf{y}
\end{bmatrix}
\mathbf{p}
-
\begin{bmatrix}
\int_{\partial\Omega}
G(\mathbf{x}_1,\mathbf{y})\mathbf{T}\left(y\right)\ \mathrm{d}S_\mathbf{y}\\
\int_{\partial\Omega}
G(\mathbf{x}_2,\mathbf{y})\mathbf{T}\left(y\right)\ \mathrm{d}S_\mathbf{y}\\
\vdots\\
\int_{\partial\Omega}
G(\mathbf{x}_n,\mathbf{y})\mathbf{T}\left(y\right)\ \mathrm{d}S_\mathbf{y}
\end{bmatrix}
\frac{\partial \mathbf{p}}{\partial \mathbf{n}_\mathbf{y}}
$$

which we usually write in the simplified form

$$
\text{diag}(\mathbf{C}^+)\mathbf{p} = \mathbf{F}\mathbf{p} - \mathbf{G}\frac{\partial \mathbf{p}}{\partial \mathbf{n}_\mathbf{y}}.
$$

After applying boundary conditions and some rearranging one ends up at

$$
\mathbf{A}\mathbf{z} = \mathbf{b}.
$$

Its important to note that this introduction skips a crucial step, namely how to [compute the actual integrals ](/pubs/pde/BEM_integrals/)in the collocation step. In short this computation happens in two steps 
1. Discretize the domain into so-called elements using so-scalled [shape functions](/pubs/pde/BEM_shapefunctions/). 
2. Approximate the integrals using a [quadrature scheme](/pubs/pde/BEM_quadrature/).
